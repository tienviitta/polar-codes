"""
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.5434 -1.6263 -0.8925  1.1141 -1.3152  1.1351  0.6307 -1.6133], scale: 0.71
sbit:
[ 6.1591 -6.49   -3.5616  4.4458 -5.2482  4.5295  2.5168 -6.4381], norm: 0.50
L:
[[ 0.      0.      0.      6.1591]
 [ 0.      0.      0.     -6.49  ]
 [ 0.      0.      0.     -3.5616]
 [ 0.      0.      0.      4.4458]
 [ 0.      0.      0.     -5.2482]
 [ 0.      0.      0.      4.5295]
 [ 0.      0.      0.      2.5168]
 [ 0.      0.      0.     -6.4381]]
s_hat:
[[-1 -1 -1]
 [-1 -1 -1]
 [-1 -1 -1]
 [-1 -1 -1]
 [-1 -1 -1]
 [-1 -1 -1]
 [-1 -1 -1]
 [-1 -1 -1]]
  i: 1, l: 0, s_block: 1
  i: 3, l: 0, s_block: 1
  i: 3, l: 1, s_block: 2
  i: 5, l: 0, s_block: 1
  i: 7, l: 0, s_block: 1
  i: 7, l: 1, s_block: 2
L:
[[  2.5168   2.5168  -5.2482   6.1591]
 [  6.9626   4.4458  -4.5295  -6.49  ]
 [  7.7651  -7.7651  -2.5168  -3.5616]
 [-16.7404  -8.9753  -4.4458   4.4458]
 [  6.0784  -6.0784 -11.4073  -5.2482]
 [-16.9623 -10.8839  11.0195   4.5295]
 [-17.4858  17.4858   6.0784   2.5168]
 [-39.3891 -21.9033 -10.8839  -6.4381]]


s_hat: vs s:
[0 0 1] [0 0 1]
[0 0 1] [0 0 1]
[0 1 1] [0 1 1]
[1 1 1] [1 1 1]
[0 1 1] [0 1 1]
[1 1 0] [1 1 0]
[1 0 0] [1 0 0]
[1 1 1] [1 1 1]

s:
[0 0 1]
[0 0 1]
[0 1 1]
[1 1 1]
[0 1 1]
[1 1 0]
[1 0 0]
[1 1 1]

u:
[0 0 0 1 0 1 1 1]
u_hat:
[0 0 0 1 0 1 1 1]
PASS: True
SYMS: True
"""

"""

  master U:3  ❲c❳ base  ~/work/repos/polar-codes                                                                                                              08:10:56  peva 
❯ conda activate pynr-env
  master U:3  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                          08:10:56  peva 
❯  /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 52191 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 -K 4 -S 5 
Polar: N:8, n:3
Q_N: [0 1 2 4 3 5 6 7]
a:
[1 0 1 1]
u:
[0 0 0 1 0 0 1 1]
s:
[[0 0 1 1]
 [0 0 1 0]
 [0 1 1 1]
 [1 1 1 0]
 [0 0 0 0]
 [0 0 1 1]
 [1 0 0 0]
 [1 1 1 1]]
x:
[1 0 1 0 0 1 0 1]
y:
[ 2.4336  0.6439 -0.8452  3.2353 -0.2843 -1.8357  1.265  -1.466 ], awgn: 1.41
sbit:
[ 2.4393  0.6454 -0.8472  3.243  -0.285  -1.8401  1.268  -1.4694], norm: 2.00
L:
[[ 0.      0.      0.      2.4393]
 [ 0.      0.      0.      0.6454]
 [ 0.      0.      0.     -0.8472]
 [ 0.      0.      0.      3.243 ]
 [ 0.      0.      0.     -0.285 ]
 [ 0.      0.      0.     -1.8401]
 [ 0.      0.      0.      1.268 ]
 [ 0.      0.      0.     -1.4694]]
L:
[[ 0.285   0.285  -0.285   2.4393]
 [ 0.9304  0.6454 -0.6454  0.6454]
 [ 1.1322 -1.1322 -0.8472 -0.8472]
 [-3.2471 -2.1149 -1.4694  3.243 ]
 [-2.1152 -2.1152 -2.7243 -0.285 ]
 [ 0.3703  2.4855 -2.4855 -1.8401]
 [ 0.6092 -0.6092  2.1152  1.268 ]
 [-7.8071 -7.1979 -4.7124 -1.4694]]
 
s_hat:
[[0 0 1]
 [0 0 1]
 [0 1 1]
 [1 1 1]
 [0 0 1]
 [0 0 1]
 [0 1 1]
 [1 1 1]]
 
s:
[[0 0 1 1]
 [0 0 1 0]
 [0 1 1 1]
 [1 1 1 0]
 [0 0 0 0]
 [0 0 1 1]
 [1 0 0 0]
 [1 1 1 1]]

SYMS: False
a:
[1 0 1 1]
a_hat:
[1 0 0 1]
PASS: False
  master U:3  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                          08:10:57  peva 
❯ 

"""

"""
  master U:3  ❲c❳ base  ~/work/repos/polar-codes                                                                                                              08:54:19  peva 
❯ conda activate pynr-env
  master U:3  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                          08:54:19  peva 
❯  /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 46411 -- /home/peva/work/repos/polar-codes/test_polar.py -N 16 -K 8 -E 0 -S 7 
Polar: N: 16, n: 4, K: 8, EsN0: 0.0 dB, seed: 7
Q_N: [ 0  1  2  4  8  3  5  9  6 10 12  7 11 13 14 15]
a:
[1 0 1 0 1 1 1 1]
u:
[0 0 0 0 1 0 0 0 0 1 0 0 1 1 1 1]
s:
[[0 0 0 1 0]
 [0 0 0 0 1]
 [0 0 0 0 0]
 [0 0 0 0 1]
 [1 1 1 1 1]
 [0 0 0 0 0]
 [0 0 0 0 0]
 [0 0 0 0 1]
 [0 1 1 1 1]
 [1 1 1 1 1]
 [0 0 0 0 0]
 [0 0 0 1 1]
 [1 0 0 0 0]
 [1 1 0 0 0]
 [1 0 0 0 0]
 [1 1 1 1 1]]
x:
[0 1 0 1 1 0 0 1 1 1 0 1 0 0 0 1]
y:
[ 1.0328 -0.5925  0.2111 -0.9979 -1.0009 -0.7547  2.0177 -0.3995 -1.6254
 -1.1715  1.5053 -1.2614  0.7573 -0.4532  1.5546 -0.8761], awgn: 1.00
sbit:
[ 2.0656 -1.185   0.4222 -1.9959 -2.0018 -1.5094  4.0353 -0.799  -3.2509
 -2.3431  3.0106 -2.5227  1.5145 -0.9065  3.1092 -1.7522], norm: 1.00
L:
[[ 0.      0.      0.      0.      2.0656]
 [ 0.      0.      0.      0.     -1.185 ]
 [ 0.      0.      0.      0.      0.4222]
 [ 0.      0.      0.      0.     -1.9959]
 [ 0.      0.      0.      0.     -2.0018]
 [ 0.      0.      0.      0.     -1.5094]
 [ 0.      0.      0.      0.      4.0353]
 [ 0.      0.      0.      0.     -0.799 ]
 [ 0.      0.      0.      0.     -3.2509]
 [ 0.      0.      0.      0.     -2.3431]
 [ 0.      0.      0.      0.      3.0106]
 [ 0.      0.      0.      0.     -2.5227]
 [ 0.      0.      0.      0.      1.5145]
 [ 0.      0.      0.      0.     -0.9065]
 [ 0.      0.      0.      0.      3.1092]
 [ 0.      0.      0.      0.     -1.7522]]
L:
[[  0.4222   0.4222   1.5145  -2.0656   2.0656]
 [  1.2212   0.799    0.9065   1.185   -1.185 ]
 [  1.7055   1.9367   0.4222   0.4222   0.4222]
 [  3.6421   1.7055   0.799    1.9959  -1.9959]
 [ -2.0915  -3.5313  -3.5801  -1.5145  -2.0018]
 [  5.6228   2.0915   2.0915   0.9065  -1.5094]
 [  4.8863   7.1115   3.5313   3.1092   4.0353]
 [ 11.9978   4.8863   2.7949   0.799   -0.799 ]
 [ -2.4159  -3.4328  -3.5163  -5.3165  -3.2509]
 [ -1.0168   2.4159   2.4159  -3.5281  -2.3431]
 [  0.1353   6.949    3.4328   3.4328   3.0106]
 [  7.0843   0.1353   2.5512  -4.5186  -2.5227]
 [ -1.1121   8.8328   8.8328   3.5163   1.5145]
 [ -9.9449  -1.1121   1.1121  -2.4159  -0.9065]
 [ -8.182   19.41    10.5772   7.1445   3.1092]
 [-27.592   -8.182   -7.0698  -2.5512  -1.7522]]
s_hat:
[[0 0 0 1]
 [0 0 0 0]
 [0 0 0 0]
 [0 0 0 0]
 [1 1 1 1]
 [0 0 0 0]
 [0 0 0 0]
 [0 0 0 0]
 [0 1 1 1]
 [1 1 1 1]
 [0 0 0 0]
 [0 0 0 1]
 [1 0 0 0]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
SYMS: False
a:
[1 0 1 0 1 1 1 1]
a_hat:
[1 0 1 0 1 1 1 1]
PASS: True
  master U:3  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                          08:54:20  peva 
❯ 
"""

"""
  master U:2  ❲c❳ base  ~/work/repos/polar-codes                                                                                                              09:04:06  peva 
❯ conda activate pynr-env
  master U:2  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                          09:04:06  peva 
❯  /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 56969 -- /home/peva/work/repos/polar-codes/test_polar.py -N 16 -K 8 -E 0 -S 7 
Polar: N: 16, n: 4, K: 8, EsN0: 0.0 dB, seed: 7
Q_N: [ 0  1  2  4  8  3  5  9  6 10 12  7 11 13 14 15]
Q_I: [ 0  0  0  0  1  0  0  1  0  1  1  0  1  1  1  1]
a:
[1 0 1 0 1 1 1 1]
u:
[0 0 0 0 1 0 0 0 0 1 0 0 1 1 1 1]
s:
[[0 0 0 1 0]
 [0 0 0 0 1]
 [0 0 0 0 0]
 [0 0 0 0 1]
 [1 1 1 1 1]
 [0 0 0 0 0]
 [0 0 0 0 0]
 [0 0 0 0 1]
 [0 1 1 1 1]
 [1 1 1 1 1]
 [0 0 0 0 0]
 [0 0 0 1 1]
 [1 0 0 0 0]
 [1 1 0 0 0]
 [1 0 0 0 0]
 [1 1 1 1 1]]
x:
[0 1 0 1 1 0 0 1 1 1 0 1 0 0 0 1]
y:
[ 1.0328 -0.5925  0.2111 -0.9979 -1.0009 -0.7547  2.0177 -0.3995 -1.6254
 -1.1715  1.5053 -1.2614  0.7573 -0.4532  1.5546 -0.8761], awgn: 1.00
sbit:
[ 2.0656 -1.185   0.4222 -1.9959 -2.0018 -1.5094  4.0353 -0.799  -3.2509
 -2.3431  3.0106 -2.5227  1.5145 -0.9065  3.1092 -1.7522], norm: 1.00
L:
[[ 0.      0.      0.      0.      2.0656]
 [ 0.      0.      0.      0.     -1.185 ]
 [ 0.      0.      0.      0.      0.4222]
 [ 0.      0.      0.      0.     -1.9959]
 [ 0.      0.      0.      0.     -2.0018]
 [ 0.      0.      0.      0.     -1.5094]
 [ 0.      0.      0.      0.      4.0353]
 [ 0.      0.      0.      0.     -0.799 ]
 [ 0.      0.      0.      0.     -3.2509]
 [ 0.      0.      0.      0.     -2.3431]
 [ 0.      0.      0.      0.      3.0106]
 [ 0.      0.      0.      0.     -2.5227]
 [ 0.      0.      0.      0.      1.5145]
 [ 0.      0.      0.      0.     -0.9065]
 [ 0.      0.      0.      0.      3.1092]
 [ 0.      0.      0.      0.     -1.7522]]
L:
[[  0.4222   0.4222   1.5145  -2.0656   2.0656]
 [  1.2212   0.799    0.9065   1.185   -1.185 ]
 [  1.7055   1.9367   0.4222   0.4222   0.4222]
 [  3.6421   1.7055   0.799    1.9959  -1.9959]
 [ -2.0915  -3.5313  -3.5801  -1.5145  -2.0018]
 [  5.6228   2.0915   2.0915   0.9065  -1.5094]
 [  4.8863   7.1115   3.5313   3.1092   4.0353]
 [ 11.9978   4.8863   2.7949   0.799   -0.799 ]
 [ -2.4159  -3.4328  -3.5163  -5.3165  -3.2509]
 [ -1.0168   2.4159   2.4159  -3.5281  -2.3431]
 [  0.1353   6.949    3.4328   3.4328   3.0106]
 [  7.0843   0.1353   2.5512  -4.5186  -2.5227]
 [ -1.1121   8.8328   8.8328   3.5163   1.5145]
 [ -9.9449  -1.1121   1.1121  -2.4159  -0.9065]
 [ -8.182   19.41    10.5772   7.1445   3.1092]
 [-27.592   -8.182   -7.0698  -2.5512  -1.7522]]
s_hat:
[[0 0 0 1]
 [0 0 0 0]
 [0 0 0 0]
 [0 0 0 0]
 [1 1 1 1]
 [0 0 0 0]
 [0 0 0 0]
 [0 0 0 0]
 [0 1 1 1]
 [1 1 1 1]
 [0 0 0 0]
 [0 0 0 1]
 [1 0 0 0]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
SYMS: False
a:
[1 0 1 0 1 1 1 1]
a_hat:
[1 0 1 0 1 1 1 1]
PASS: True
  master U:2  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                          09:04:07  peva 
❯ 
"""
