"""
The "chk" version: upper_llr(top_llr, btm_llr)

Design SNR: 0.0 dB

test_polar_nopunct.py -M 8 -K 5 

========== Polar Code ==========
N: 8
M: 8
K: 5
Mothercode Construction: bb
Ordered Bits (least reliable to most reliable): [0 4 2 1 6 5 3 7]
Frozen Bits: [2 4 0]
Puncturing Flag: False
Puncturing Parameters: {punct_type: 
                        punct_algorithm: 
                        punct_set: []
                        source_set: []
                        update_frozen_flag: None}
 


The message is: [1 0 0 1 0]
The coded message is: [0 1 1 0 1 0 1 0]
The log-likelihoods are: [ 0.16082923 -2.05397914 -1.45657378  0.55757278  0.02308327  1.96730347 -1.74552562  1.37325182]

Natural order?:
l = [0, 4, 2, 6, 1, 5, 3, 7]

l = 0:
array([[ 0.1608, -0.1242,  0.021 , -0.0001],
       [-2.054 ,     nan,     nan,     nan],
       [-1.4566, -0.3414,     nan,     nan],
       [ 0.5576,     nan,     nan,     nan],
       [ 0.0231,  0.0174, -0.0073,     nan],
       [ 1.9673,     nan,     nan,     nan],
       [-1.7455, -0.8923,     nan,     nan],
       [ 1.3733,     nan,     nan,     nan]])
array([[nan, nan, nan,  0.],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan]])

l = 4:
array([[ 0.1608, -0.1242,  0.021 , -0.0001],
       [-2.054 ,     nan,     nan,     nan],
       [-1.4566, -0.3414,     nan,     nan],
       [ 0.5576,     nan,     nan,     nan],
       [ 0.0231,  0.0174, -0.0073,  0.0137],
       [ 1.9673,     nan,     nan,     nan],
       [-1.7455, -0.8923,     nan,     nan],
       [ 1.3733,     nan,     nan,     nan]])
array([[nan, nan,  0.,  0.],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan],
       [nan, nan,  0.,  0.],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan]])

l = 2:
array([[ 0.1608, -0.1242,  0.021 , -0.0001],
       [-2.054 ,     nan,     nan,     nan],
       [-1.4566, -0.3414, -0.4655,  0.1887],
       [ 0.5576,     nan,     nan,     nan],
       [ 0.0231,  0.0174, -0.0073,  0.0137],
       [ 1.9673,     nan,     nan,     nan],
       [-1.7455, -0.8923, -0.8749,     nan],
       [ 1.3733,     nan,     nan,     nan]])
array([[nan, nan,  0.,  0.],
       [nan, nan, nan, nan],
       [nan, nan, nan,  0.],
       [nan, nan, nan, nan],
       [nan, nan,  0.,  0.],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan]])

l = 6:
array([[ 0.1608, -0.1242,  0.021 , -0.0001],
       [-2.054 ,     nan,     nan,     nan],
       [-1.4566, -0.3414, -0.4655,  0.1887],
       [ 0.5576,     nan,     nan,     nan],
       [ 0.0231,  0.0174, -0.0073,  0.0137],
       [ 1.9673,     nan,     nan,     nan],
       [-1.7455, -0.8923, -0.8749, -1.3404],
       [ 1.3733,     nan,     nan,     nan]])
array([[nan,  1.,  0.,  0.],
       [nan, nan, nan, nan],
       [nan,  1.,  1.,  0.],
       [nan, nan, nan, nan],
       [nan,  1.,  0.,  0.],
       [nan, nan, nan, nan],
       [nan,  1.,  1.,  1.],
       [nan, nan, nan, nan]])

l = 1:
array([[ 0.1608, -0.1242,  0.021 , -0.0001],
       [-2.054 , -2.2148, -1.4308, -0.8986],
       [-1.4566, -0.3414, -0.4655,  0.1887],
       [ 0.5576,  2.0141,     nan,     nan],
       [ 0.0231,  0.0174, -0.0073,  0.0137],
       [ 1.9673,  1.9442,  1.6813,     nan],
       [-1.7455, -0.8923, -0.8749, -1.3404],
       [ 1.3733,  3.1188,     nan,     nan]])
array([[nan,  1.,  0.,  0.],
       [nan, nan, nan,  1.],
       [nan,  1.,  1.,  0.],
       [nan, nan, nan, nan],
       [nan,  1.,  0.,  0.],
       [nan, nan, nan, nan],
       [nan,  1.,  1.,  1.],
       [nan, nan, nan, nan]])

l = 5:
array([[ 0.1608, -0.1242,  0.021 , -0.0001],
       [-2.054 , -2.2148, -1.4308, -0.8986],
       [-1.4566, -0.3414, -0.4655,  0.1887],
       [ 0.5576,  2.0141,     nan,     nan],
       [ 0.0231,  0.0174, -0.0073,  0.0137],
       [ 1.9673,  1.9442,  1.6813,  3.1121],
       [-1.7455, -0.8923, -0.8749, -1.3404],
       [ 1.3733,  3.1188,     nan,     nan]])
array([[nan,  1.,  0.,  0.],
       [nan, nan,  1.,  1.],
       [nan,  1.,  1.,  0.],
       [nan, nan, nan, nan],
       [nan,  1.,  0.,  0.],
       [nan, nan,  0.,  0.],
       [nan,  1.,  1.,  1.],
       [nan, nan, nan, nan]])

l = 3:
array([[ 0.1608, -0.1242,  0.021 , -0.0001],
       [-2.054 , -2.2148, -1.4308, -0.8986],
       [-1.4566, -0.3414, -0.4655,  0.1887],
       [ 0.5576,  2.0141,  4.229 ,  3.8684],
       [ 0.0231,  0.0174, -0.0073,  0.0137],
       [ 1.9673,  1.9442,  1.6813,  3.1121],
       [-1.7455, -0.8923, -0.8749, -1.3404],
       [ 1.3733,  3.1188,  5.063 ,     nan]])
array([[nan,  1.,  0.,  0.],
       [nan, nan,  1.,  1.],
       [nan,  1.,  1.,  0.],
       [nan, nan, nan,  0.],
       [nan,  1.,  0.,  0.],
       [nan, nan,  0.,  0.],
       [nan,  1.,  1.,  1.],
       [nan, nan, nan, nan]])

l = 7:
array([[ 0.1608, -0.1242,  0.021 , -0.0001],
       [-2.054 , -2.2148, -1.4308, -0.8986],
       [-1.4566, -0.3414, -0.4655,  0.1887],
       [ 0.5576,  2.0141,  4.229 ,  3.8684],
       [ 0.0231,  0.0174, -0.0073,  0.0137],
       [ 1.9673,  1.9442,  1.6813,  3.1121],
       [-1.7455, -0.8923, -0.8749, -1.3404],
       [ 1.3733,  3.1188,  5.063 ,  9.292 ]])
array([[0., 1., 0., 0.],
       [1., 1., 1., 1.],
       [1., 1., 1., 0.],
       [0., 0., 0., 0.],
       [1., 1., 0., 0.],
       [0., 0., 0., 0.],
       [1., 1., 1., 1.],
       [0., 0., 0., 0.]])

self.x_noisy: array([0, 1, 0, 0, 0, 0, 1, 0])

myPC.message_received: array([1, 0, 0, 1, 0])

The decoded message is: [1 0 0 1 0]
PASS: True

"""

"""
The "f_-(\alpha, \beta)" approximation: upper_llr_approx(top_llr, btm_llr)

Design SNR: 0.0 dB

test_polar_nopunct.py -M 8 -K 5 

========== Polar Code ==========
N: 8
M: 8
K: 5

Ordered Bits (least reliable to most reliable): [0 4 2 1 6 5 3 7]
Frozen Bits: [2 4 0]

The message is: [1 0 0 1 0]
The coded message is: [0 1 1 0 1 0 1 0]
The log-likelihoods are: [ 0.1608 -2.054  -1.4566  0.5576  0.0231  1.9673 -1.7455  1.3733]

Order: l = [0, 4, 2, 6, 1, 5, 3, 7]

l = 0:
LLR = [[ 0.1608, -0.1608,  0.1608, -0.0231],
       [-2.054 ,     nan,     nan,     nan],
       [-1.4566, -0.5576,     nan,     nan],
       [ 0.5576,     nan,     nan,     nan],
       [ 0.0231,  0.0231, -0.0231,     nan],
       [ 1.9673,     nan,     nan,     nan],
       [-1.7455, -1.3733,     nan,     nan],
       [ 1.3733,     nan,     nan,     nan]])
BIT = [[nan, nan, nan,  0.],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan]])

l = 4:
LLR = [[ 0.1608, -0.1608,  0.1608, -0.0231],
       [-2.054 ,     nan,     nan,     nan],
       [-1.4566, -0.5576,     nan,     nan],
       [ 0.5576,     nan,     nan,     nan],
       [ 0.0231,  0.0231, -0.0231,  0.1377],
       [ 1.9673,     nan,     nan,     nan],
       [-1.7455, -1.3733,     nan,     nan],
       [ 1.3733,     nan,     nan,     nan]])
BIT = [[nan, nan,  0.,  0.],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan],
       [nan, nan,  0.,  0.],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan]])

l = 2:
LLR = [[ 0.1608, -0.1608,  0.1608, -0.0231],
       [-2.054 ,     nan,     nan,     nan],
       [-1.4566, -0.5576, -0.7184,  0.7184],
       [ 0.5576,     nan,     nan,     nan],
       [ 0.0231,  0.0231, -0.0231,  0.1377],
       [ 1.9673,     nan,     nan,     nan],
       [-1.7455, -1.3733, -1.3502,     nan],
       [ 1.3733,     nan,     nan,     nan]])
BIT = [[nan, nan,  0.,  0.],
       [nan, nan, nan, nan],
       [nan, nan, nan,  0.],
       [nan, nan, nan, nan],
       [nan, nan,  0.,  0.],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan],
       [nan, nan, nan, nan]])

l = 6:
LLR = [[ 0.1608, -0.1608,  0.1608, -0.0231],
       [-2.054 ,     nan,     nan,     nan],
       [-1.4566, -0.5576, -0.7184,  0.7184],
       [ 0.5576,     nan,     nan,     nan],
       [ 0.0231,  0.0231, -0.0231,  0.1377],
       [ 1.9673,     nan,     nan,     nan],
       [-1.7455, -1.3733, -1.3502, -2.0686],
       [ 1.3733,     nan,     nan,     nan]])
BIT = [[nan,  1.,  0.,  0.],
       [nan, nan, nan, nan],
       [nan,  1.,  1.,  0.],
       [nan, nan, nan, nan],
       [nan,  1.,  0.,  0.],
       [nan, nan, nan, nan],
       [nan,  1.,  1.,  1.],
       [nan, nan, nan, nan]])

l = 1:
LLR = [[ 0.1608, -0.1608,  0.1608, -0.0231],
       [-2.054 , -2.2148, -2.0141, -1.9442],
       [-1.4566, -0.5576, -0.7184,  0.7184],
       [ 0.5576,  2.0141,     nan,     nan],
       [ 0.0231,  0.0231, -0.0231,  0.1377],
       [ 1.9673,  1.9442,  1.9442,     nan],
       [-1.7455, -1.3733, -1.3502, -2.0686],
       [ 1.3733,  3.1188,     nan,     nan]])
BIT = [[nan,  1.,  0.,  0.],
       [nan, nan, nan,  1.],
       [nan,  1.,  1.,  0.],
       [nan, nan, nan, nan],
       [nan,  1.,  0.,  0.],
       [nan, nan, nan, nan],
       [nan,  1.,  1.,  1.],
       [nan, nan, nan, nan]])

l = 5:
LLR = [[ 0.1608, -0.1608,  0.1608, -0.0231],
       [-2.054 , -2.2148, -2.0141, -1.9442],
       [-1.4566, -0.5576, -0.7184,  0.7184],
       [ 0.5576,  2.0141,     nan,     nan],
       [ 0.0231,  0.0231, -0.0231,  0.1377],
       [ 1.9673,  1.9442,  1.9442,  3.9584],
       [-1.7455, -1.3733, -1.3502, -2.0686],
       [ 1.3733,  3.1188,     nan,     nan]])
BIT = [[nan,  1.,  0.,  0.],
       [nan, nan,  1.,  1.],
       [nan,  1.,  1.,  0.],
       [nan, nan, nan, nan],
       [nan,  1.,  0.,  0.],
       [nan, nan,  0.,  0.],
       [nan,  1.,  1.,  1.],
       [nan, nan, nan, nan]])

l = 3:
LLR = [[ 0.1608, -0.1608,  0.1608, -0.0231],
       [-2.054 , -2.2148, -2.0141, -1.9442],
       [-1.4566, -0.5576, -0.7184,  0.7184],
       [ 0.5576,  2.0141,  4.229 ,  4.229 ],
       [ 0.0231,  0.0231, -0.0231,  0.1377],
       [ 1.9673,  1.9442,  1.9442,  3.9584],
       [-1.7455, -1.3733, -1.3502, -2.0686],
       [ 1.3733,  3.1188,  5.063 ,     nan]])
BIT = [[nan,  1.,  0.,  0.],
       [nan, nan,  1.,  1.],
       [nan,  1.,  1.,  0.],
       [nan, nan, nan,  0.],
       [nan,  1.,  0.,  0.],
       [nan, nan,  0.,  0.],
       [nan,  1.,  1.,  1.],
       [nan, nan, nan, nan]])

l = 7:
LLR = [[ 0.1608, -0.1608,  0.1608, -0.0231],
       [-2.054 , -2.2148, -2.0141, -1.9442],
       [-1.4566, -0.5576, -0.7184,  0.7184],
       [ 0.5576,  2.0141,  4.229 ,  4.229 ],
       [ 0.0231,  0.0231, -0.0231,  0.1377],
       [ 1.9673,  1.9442,  1.9442,  3.9584],
       [-1.7455, -1.3733, -1.3502, -2.0686],
       [ 1.3733,  3.1188,  5.063 ,  9.292 ]])
BIT = [[0., 1., 0., 0.],
       [1., 1., 1., 1.],
       [1., 1., 1., 0.],
       [0., 0., 0., 0.],
       [1., 1., 0., 0.],
       [0., 0., 0., 0.],
       [1., 1., 1., 1.],
       [0., 0., 0., 0.]])

x: array([0, 1, 0, 0, 0, 0, 1, 0])

mmsg: array([1, 0, 0, 1, 0])

The decoded message is: [1 0 0 1 0]
PASS: True

"""

"""

debug> dec2bin(0:63)
ans =

    0    000000    000000     0    
    1    000001    100000    32    
    2    000010    010000    16    
    3    000011    110000    48    
    4    000100    001000     8    
    5    000101    101000    40    
    6    000110    011000    24    
    7    000111    111000    56    
    8    001000    000100     4    
    9    001001    100100    36    
   10    001010    010100    20    
   11    001011    110100    52    
   12    001100    001100    12    
   13    001101    101100    44    
   14    001110    011100    28    
   15    001111    111100    60    
   16    010000    000010     2    
   17    010001    100010    34    
   18    010010    010010    18    
   19    010011    110010    50    
   20    010100    001010    10    
   21    010101    101010    42    
   22    010110    011010    26    
   23    010111    111010    58    
   24    011000    000110     6    
   25    011001    100110    38    
   26    011010    010110    22    
   27    011011    110110    54    
   28    011100    001110    14    
   29    011101    101110    46    
   30    011110    011110    30    
   31    011111    111110    62    
   32    100000    000001     1    
   33    100001    100001    33    
   34    100010    010001    17    
   35    100011    110001    49    
   36    100100    001001     9    
   37    100101    101001    41    
   38    100110    011001    25    
   39    100111    111001    57    
   40    101000    000101     5    
   41    101001    100101    37    
   42    101010    010101    21    
   43    101011    110101    53    
   44    101100    001101    13    
   45    101101    101101    45    
   46    101110    011101    29    
   47    101111    111101    61    
   48    110000    000011     3    
   49    110001    100011    35    
   50    110010    010011    19    
   51    110011    110011    51    
   52    110100    001011    11    
   53    110101    101011    43    
   54    110110    011011    27    
   55    110111    111011    59    
   56    111000    000111     7    
   57    111001    100111    39    
   58    111010    010111    23    
   59    111011    110111    55    
   60    111100    001111    15    
   61    111101    101111    47    
   62    111110    011111    31    
   63    111111    111111    63    

llrs =

   42.0320   54.6237   61.9664  -63.9865  -63.9865   63.9865   77.0211
         0   42.0320   49.8065  -49.8065   49.8065   49.8065   65.8458
         0         0   54.6237  -54.6237  -59.3189   70.5808  -71.8363
         0         0   42.0320  -65.7106  -70.3572   70.3572  -73.0364
         0         0         0  -61.9664  -61.9664  -61.9664   67.9582
         0         0         0  -52.4853  -52.4853   52.4853   52.4853
         0         0         0  -56.7513  -56.7513   56.7513   56.7513
         0         0         0  -42.0320   52.9941  -52.9941   52.9941
         0         0         0         0   64.0699  -64.0699  -68.9209
         0         0         0         0  -51.7757  -51.7757   74.7909
         0         0         0         0   54.6237  -54.6237   57.1616
         0         0         0         0   65.7106  -80.7070   84.3766
         0         0         0         0   65.3518   70.0175   70.0175
         0         0         0         0   62.0448  -62.0448   62.0448
         0         0         0         0   62.2845  -62.2845  -62.7677
         0         0         0         0  -42.0320   42.0320   42.0320
         0         0         0         0         0  -65.3137  -65.3137
         0         0         0         0         0   84.2415   84.2415
         0         0         0         0         0  -59.3189  -59.3189
         0         0         0         0         0  -76.8016  -76.8016
         0         0         0         0         0   64.4147   64.4147
         0         0         0         0         0  -67.4293  -67.4293
         0         0         0         0         0  -68.5642  -68.5642
         0         0         0         0         0  -72.0694  -72.0694
         0         0         0         0         0  -70.7300  -70.7300
         0         0         0         0         0   74.8860   74.8860
         0         0         0         0         0  -71.7620  -71.7620
         0         0         0         0         0  -65.7106  -65.7106
         0         0         0         0         0   65.3518   65.3518
         0         0         0         0         0  -78.0044  -78.0044
         0         0         0         0         0  -69.2300  -69.2300
         0         0         0         0         0  -64.0146  -64.0146
         0         0         0         0         0         0   63.9865
         0         0         0         0         0         0   49.8065
         0         0         0         0         0         0  -70.5808
         0         0         0         0         0         0  -70.3572
         0         0         0         0         0         0  -61.9664
         0         0         0         0         0         0   67.5113
         0         0         0         0         0         0   79.3467
         0         0         0         0         0         0  -59.8898
         0         0         0         0         0         0   64.0699
         0         0         0         0         0         0  -51.7757
         0         0         0         0         0         0  -54.6237
         0         0         0         0         0         0  -80.7070
         0         0         0         0         0         0   71.9740
         0         0         0         0         0         0  -78.9895
         0         0         0         0         0         0   62.2845
         0         0         0         0         0         0   63.4942
         0         0         0         0         0         0       Inf
         0         0         0         0         0         0       Inf
         0         0         0         0         0         0       Inf
         0         0         0         0         0         0       Inf
         0         0         0         0         0         0       Inf
         0         0         0         0         0         0       Inf
         0         0         0         0         0         0       Inf
         0         0         0         0         0         0       Inf
         0         0         0         0         0         0       Inf
         0         0         0         0         0         0       Inf
         0         0         0         0         0         0       Inf
         0         0         0         0         0         0       Inf
         0         0         0         0         0         0       Inf
         0         0         0         0         0         0       Inf
         0         0         0         0         0         0       Inf
         0         0         0         0         0         0       Inf




L:
[[  0.       0.       0.      68.5216]
 [  0.       0.       0.     -66.4269]
 [  0.       0.       0.     -80.2177]
 [  0.       0.       0.      50.4733]
 [  0.       0.       0.     -49.6131]
 [  0.       0.       0.      61.2974]
 [  0.       0.       0.      64.5863]
 [  0.       0.       0.     -74.9899]]
L:
[[  49.6131   49.6131  -49.6131   68.5216]
 [ 100.0864   50.4733  -61.2974  -66.4269]
 [ 111.7707 -114.1994  -64.5863  -80.2177]
 [-225.9701 -111.7707  -50.4733   50.4733]
 [ 118.1347 -118.1347 -118.1347  -49.6131]
 [-243.5979 -125.4632  127.7243   61.2974]
 [-253.1875  262.9387  144.8039   64.5863]
 [-516.1262 -253.1875 -125.4632  -74.9899]]
Traceback (most recent call last):
  File "/home/peva/work/repos/polar-codes/test_polar.py", line 195, in <module>
    main(args.length)
  File "/home/peva/work/repos/polar-codes/test_polar.py", line 188, in main
    u_hat = np.int((1-np.sign(L[:, 0]))//2)
            ^^^^^^
  File "/home/peva/miniforge3/envs/pynr-env/lib/python3.11/site-packages/numpy/__init__.py", line 324, in __getattr__
    raise AttributeError(__former_attrs__[attr])
AttributeError: module 'numpy' has no attribute 'int'.
`np.int` was a deprecated alias for the builtin `int`. To avoid this error in existing code, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
The aliases was originally deprecated in NumPy 1.20; for more details and guidance see the original release note at:
    https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations. Did you mean: 'inf'?
  master U:2 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:35:31  peva 
 1 ❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 58797 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.0834 -1.0503 -1.2684  0.7981 -0.7845  0.9692  1.0212 -1.1857], scale: 0.1778279410038923
sbit:
[ 68.5216 -66.4269 -80.2177  50.4733 -49.6131  61.2974  64.5863 -74.9899], norm: 0.03162277660168379
L:
[[  0.       0.       0.      68.5216]
 [  0.       0.       0.     -66.4269]
 [  0.       0.       0.     -80.2177]
 [  0.       0.       0.      50.4733]
 [  0.       0.       0.     -49.6131]
 [  0.       0.       0.      61.2974]
 [  0.       0.       0.      64.5863]
 [  0.       0.       0.     -74.9899]]
L:
[[  49.6131   49.6131  -49.6131   68.5216]
 [ 100.0864   50.4733  -61.2974  -66.4269]
 [ 111.7707 -114.1994  -64.5863  -80.2177]
 [-225.9701 -111.7707  -50.4733   50.4733]
 [ 118.1347 -118.1347 -118.1347  -49.6131]
 [-243.5979 -125.4632  127.7243   61.2974]
 [-253.1875  262.9387  144.8039   64.5863]
 [-516.1262 -253.1875 -125.4632  -74.9899]]
u:
[0 0 0 1 0 1 1 1]
u_hat:
[0. 0. 0. 2. 0. 2. 2. 2.]
  master U:2 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:35:48  peva 
❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 52015 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.0834 -1.0503 -1.2684  0.7981 -0.7845  0.9692  1.0212 -1.1857], scale: 0.1778279410038923
sbit:
[ 68.5216 -66.4269 -80.2177  50.4733 -49.6131  61.2974  64.5863 -74.9899], norm: 0.03162277660168379
L:
[[  0.       0.       0.      68.5216]
 [  0.       0.       0.     -66.4269]
 [  0.       0.       0.     -80.2177]
 [  0.       0.       0.      50.4733]
 [  0.       0.       0.     -49.6131]
 [  0.       0.       0.      61.2974]
 [  0.       0.       0.      64.5863]
 [  0.       0.       0.     -74.9899]]
L:
[[  49.6131   49.6131  -49.6131   68.5216]
 [ 100.0864   50.4733  -61.2974  -66.4269]
 [ 111.7707 -114.1994  -64.5863  -80.2177]
 [-225.9701 -111.7707  -50.4733   50.4733]
 [ 118.1347 -118.1347 -118.1347  -49.6131]
 [-243.5979 -125.4632  127.7243   61.2974]
 [-253.1875  262.9387  144.8039   64.5863]
 [-516.1262 -253.1875 -125.4632  -74.9899]]
Traceback (most recent call last):
  File "/home/peva/work/repos/polar-codes/test_polar.py", line 195, in <module>
    main(args.length)
  File "/home/peva/work/repos/polar-codes/test_polar.py", line 188, in main
    u_hat = 1-np.sign(L[:, 0], dtype=int)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
numpy.core._exceptions._UFuncInputCastingError: Cannot cast ufunc 'sign' input from dtype('float64') to dtype('int64') with casting rule 'same_kind'
  master U:2 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:36:00  peva 
 1 ❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 51479 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.0834 -1.0503 -1.2684  0.7981 -0.7845  0.9692  1.0212 -1.1857], scale: 0.1778279410038923
sbit:
[ 68.5216 -66.4269 -80.2177  50.4733 -49.6131  61.2974  64.5863 -74.9899], norm: 0.03162277660168379
L:
[[  0.       0.       0.      68.5216]
 [  0.       0.       0.     -66.4269]
 [  0.       0.       0.     -80.2177]
 [  0.       0.       0.      50.4733]
 [  0.       0.       0.     -49.6131]
 [  0.       0.       0.      61.2974]
 [  0.       0.       0.      64.5863]
 [  0.       0.       0.     -74.9899]]
L:
[[  49.6131   49.6131  -49.6131   68.5216]
 [ 100.0864   50.4733  -61.2974  -66.4269]
 [ 111.7707 -114.1994  -64.5863  -80.2177]
 [-225.9701 -111.7707  -50.4733   50.4733]
 [ 118.1347 -118.1347 -118.1347  -49.6131]
 [-243.5979 -125.4632  127.7243   61.2974]
 [-253.1875  262.9387  144.8039   64.5863]
 [-516.1262 -253.1875 -125.4632  -74.9899]]
u:
[0 0 0 1 0 1 1 1]
u_hat:
[0 0 0 2 0 2 2 2]
  master U:2 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:36:40  peva 
❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 59345 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.0834 -1.0503 -1.2684  0.7981 -0.7845  0.9692  1.0212 -1.1857], scale: 0.1778279410038923
sbit:
[ 68.5216 -66.4269 -80.2177  50.4733 -49.6131  61.2974  64.5863 -74.9899], norm: 0.03162277660168379
L:
[[  0.       0.       0.      68.5216]
 [  0.       0.       0.     -66.4269]
 [  0.       0.       0.     -80.2177]
 [  0.       0.       0.      50.4733]
 [  0.       0.       0.     -49.6131]
 [  0.       0.       0.      61.2974]
 [  0.       0.       0.      64.5863]
 [  0.       0.       0.     -74.9899]]
L:
[[  49.6131   49.6131  -49.6131   68.5216]
 [ 100.0864   50.4733  -61.2974  -66.4269]
 [ 111.7707 -114.1994  -64.5863  -80.2177]
 [-225.9701 -111.7707  -50.4733   50.4733]
 [ 118.1347 -118.1347 -118.1347  -49.6131]
 [-243.5979 -125.4632  127.7243   61.2974]
 [-253.1875  262.9387  144.8039   64.5863]
 [-516.1262 -253.1875 -125.4632  -74.9899]]
u:
[0 0 0 1 0 1 1 1]
u_hat:
[0 0 0 1 0 1 1 1]
  master U:2 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:36:53  peva 
❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 49425 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.3321 -1.2003 -2.0683  0.196  -0.1419  0.8774  1.0844 -1.7393], scale: 0.7079457843841379
sbit:
[ 5.3158 -4.7896 -8.2537  0.7823 -0.5662  3.5012  4.3273 -6.9406], norm: 0.5011872336272722
L:
[[ 0.      0.      0.      5.3158]
 [ 0.      0.      0.     -4.7896]
 [ 0.      0.      0.     -8.2537]
 [ 0.      0.      0.      0.7823]
 [ 0.      0.      0.     -0.5662]
 [ 0.      0.      0.      3.5012]
 [ 0.      0.      0.      4.3273]
 [ 0.      0.      0.     -6.9406]]
L:
[[  0.5662   0.5662  -0.5662   5.3158]
 [  1.3485   0.7823  -3.5012  -4.7896]
 [  4.2835  -4.8935  -4.3273  -8.2537]
 [ -9.177   -4.2835  -0.7823   0.7823]
 [  5.882   -5.882   -5.882   -0.5662]
 [-13.6049  -7.7228   8.2908   3.5012]
 [-16.0137  18.463   12.581    4.3273]
 [-34.4767 -16.0137  -7.7228  -6.9406]]
u:
[0 0 0 1 0 1 1 1]
u_hat:
[0 0 0 1 0 1 1 1]
  master U:2 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:37:03  peva 
❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 46453 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.6626 -1.3996 -3.1316 -0.6041  0.7122  0.7553  1.1684 -2.475 ], scale: 1.4125375446227544
sbit:
[ 1.6666 -1.4029 -3.139  -0.6056  0.7138  0.7571  1.1712 -2.4809], norm: 1.9952623149688795
L:
[[ 0.      0.      0.      1.6666]
 [ 0.      0.      0.     -1.4029]
 [ 0.      0.      0.     -3.139 ]
 [ 0.      0.      0.     -0.6056]
 [ 0.      0.      0.      0.7138]
 [ 0.      0.      0.      0.7571]
 [ 0.      0.      0.      1.1712]
 [ 0.      0.      0.     -2.4809]]
L:
[[ 0.6056 -0.7138  0.7138  1.6666]
 [-1.3194 -0.6056 -0.7571 -1.4029]
 [ 0.1516 -0.4573 -1.1712 -3.139 ]
 [-0.6089 -0.1516  0.6056 -0.6056]
 [ 0.9527 -0.9527 -0.9527  0.7138]
 [-2.8281 -1.8753  2.16    0.7571]
 [-4.0353  5.2629  4.3102  1.1712]
 [-9.2983 -4.0353 -1.8753 -2.4809]]
u:
[0 0 0 1 0 1 1 1]
u_hat:
[0 1 0 1 0 1 1 1]
  master U:2 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:37:09  peva 
❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 58733 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.6626 -1.3996 -3.1316 -0.6041  0.7122  0.7553  1.1684 -2.475 ], scale: 1.4125375446227544
sbit:
[ 1.6666 -1.4029 -3.139  -0.6056  0.7138  0.7571  1.1712 -2.4809], norm: 1.9952623149688795
L:
[[ 0.      0.      0.      1.6666]
 [ 0.      0.      0.     -1.4029]
 [ 0.      0.      0.     -3.139 ]
 [ 0.      0.      0.     -0.6056]
 [ 0.      0.      0.      0.7138]
 [ 0.      0.      0.      0.7571]
 [ 0.      0.      0.      1.1712]
 [ 0.      0.      0.     -2.4809]]
L:
[[ 0.6056 -0.7138  0.7138  1.6666]
 [-1.3194 -0.6056 -0.7571 -1.4029]
 [ 0.1516 -0.4573 -1.1712 -3.139 ]
 [-0.6089 -0.1516  0.6056 -0.6056]
 [ 0.9527 -0.9527 -0.9527  0.7138]
 [-2.8281 -1.8753  2.16    0.7571]
 [-4.0353  5.2629  4.3102  1.1712]
 [-9.2983 -4.0353 -1.8753 -2.4809]]
u:
[0 0 0 1 0 1 1 1]
u_hat:
[0 1 0 1 0 1 1 1]
  master U:2 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:37:16  peva 
❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 37797 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.3321 -1.2003 -2.0683  0.196  -0.1419  0.8774  1.0844 -1.7393], scale: 0.7079457843841379
sbit:
[ 5.3158 -4.7896 -8.2537  0.7823 -0.5662  3.5012  4.3273 -6.9406], norm: 0.5011872336272722
L:
[[ 0.      0.      0.      5.3158]
 [ 0.      0.      0.     -4.7896]
 [ 0.      0.      0.     -8.2537]
 [ 0.      0.      0.      0.7823]
 [ 0.      0.      0.     -0.5662]
 [ 0.      0.      0.      3.5012]
 [ 0.      0.      0.      4.3273]
 [ 0.      0.      0.     -6.9406]]
L:
[[  0.5662   0.5662  -0.5662   5.3158]
 [  1.3485   0.7823  -3.5012  -4.7896]
 [  4.2835  -4.8935  -4.3273  -8.2537]
 [ -9.177   -4.2835  -0.7823   0.7823]
 [  5.882   -5.882   -5.882   -0.5662]
 [-13.6049  -7.7228   8.2908   3.5012]
 [-16.0137  18.463   12.581    4.3273]
 [-34.4767 -16.0137  -7.7228  -6.9406]]
u:
[0 0 0 1 0 1 1 1]
u_hat:
[0 0 0 1 0 1 1 1]
  master U:2 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:37:20  peva 
❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 35273 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.3321 -1.2003 -2.0683  0.196  -0.1419  0.8774  1.0844 -1.7393], scale: 0.7079457843841379
sbit:
[ 5.3158 -4.7896 -8.2537  0.7823 -0.5662  3.5012  4.3273 -6.9406], norm: 0.5011872336272722
L:
[[ 0.      0.      0.      5.3158]
 [ 0.      0.      0.     -4.7896]
 [ 0.      0.      0.     -8.2537]
 [ 0.      0.      0.      0.7823]
 [ 0.      0.      0.     -0.5662]
 [ 0.      0.      0.      3.5012]
 [ 0.      0.      0.      4.3273]
 [ 0.      0.      0.     -6.9406]]
L:
[[  0.5662   0.5662  -0.5662   5.3158]
 [  1.3485   0.7823  -3.5012  -4.7896]
 [  4.2835  -4.8935  -4.3273  -8.2537]
 [ -9.177   -4.2835  -0.7823   0.7823]
 [  5.882   -5.882   -5.882   -0.5662]
 [-13.6049  -7.7228   8.2908   3.5012]
 [-16.0137  18.463   12.581    4.3273]
 [-34.4767 -16.0137  -7.7228  -6.9406]]
u:
[0 0 0 1 0 1 1 1]
u_hat:
[0 0 0 1 0 1 1 1]
PASS: True
  master U:2 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:38:00  peva 
❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 52281 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.4691 -1.2829 -2.5091 -0.1356  0.2121  0.8268  1.1192 -2.0442], scale: 1.0
sbit:
[ 2.9382 -2.5657 -5.0181 -0.2713  0.4242  1.6536  2.2384 -4.0885], norm: 1.0
L:
[[ 0.      0.      0.      2.9382]
 [ 0.      0.      0.     -2.5657]
 [ 0.      0.      0.     -5.0181]
 [ 0.      0.      0.     -0.2713]
 [ 0.      0.      0.      0.4242]
 [ 0.      0.      0.      1.6536]
 [ 0.      0.      0.      2.2384]
 [ 0.      0.      0.     -4.0885]]
L:
[[  0.2713  -0.4242   0.4242   2.9382]
 [ -0.6955  -0.2713  -1.6536  -2.5657]
 [  1.3823  -1.8142  -2.2384  -5.0181]
 [ -3.1965  -1.3823   0.2713  -0.2713]
 [  2.514   -2.514   -2.514    0.4242]
 [ -6.3312  -3.8172   4.2193   1.6536]
 [ -8.0365   9.7705   7.2565   2.2384]
 [-17.807   -8.0365  -3.8172  -4.0885]]
u:
[0 0 0 1 0 1 1 1]
u_hat:
[0 1 0 1 0 1 1 1]
PASS: False
  master U:2 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:38:09  peva 
❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 37743 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.3726 -1.2247 -2.1987  0.0979 -0.0372  0.8624  1.0947 -1.8295], scale: 0.7943282347242815
sbit:
[ 4.3509 -3.882  -6.9694  0.3104 -0.1179  2.7337  3.4699 -5.799 ], norm: 0.6309573444801932
L:
[[ 0.      0.      0.      4.3509]
 [ 0.      0.      0.     -3.882 ]
 [ 0.      0.      0.     -6.9694]
 [ 0.      0.      0.      0.3104]
 [ 0.      0.      0.     -0.1179]
 [ 0.      0.      0.      2.7337]
 [ 0.      0.      0.      3.4699]
 [ 0.      0.      0.     -5.799 ]]
L:
[[  0.1179   0.1179  -0.1179   4.3509]
 [  0.4283   0.3104  -2.7337  -3.882 ]
 [  3.0441  -3.5878  -3.4699  -6.9694]
 [ -6.6319  -3.0441  -0.3104   0.3104]
 [  4.4688  -4.4688  -4.4688  -0.1179]
 [-10.5783  -6.1095   6.6157   2.7337]
 [-12.7251  14.9081  10.4393   3.4699]
 [-27.6332 -12.7251  -6.1095  -5.799 ]]
u:
[0 0 0 1 0 1 1 1]
u_hat:
[0 0 0 1 0 1 1 1]
PASS: True
  master U:2 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:38:19  peva 
❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 40205 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.3321 -1.2003 -2.0683  0.196  -0.1419  0.8774  1.0844 -1.7393], scale: 0.7079457843841379
sbit:
[ 5.3158 -4.7896 -8.2537  0.7823 -0.5662  3.5012  4.3273 -6.9406], norm: 0.5011872336272722
L:
[[ 0.      0.      0.      5.3158]
 [ 0.      0.      0.     -4.7896]
 [ 0.      0.      0.     -8.2537]
 [ 0.      0.      0.      0.7823]
 [ 0.      0.      0.     -0.5662]
 [ 0.      0.      0.      3.5012]
 [ 0.      0.      0.      4.3273]
 [ 0.      0.      0.     -6.9406]]
L:
[[  0.5662   0.5662  -0.5662   5.3158]
 [  1.3485   0.7823  -3.5012  -4.7896]
 [  4.2835  -4.8935  -4.3273  -8.2537]
 [ -9.177   -4.2835  -0.7823   0.7823]
 [  5.882   -5.882   -5.882   -0.5662]
 [-13.6049  -7.7228   8.2908   3.5012]
 [-16.0137  18.463   12.581    4.3273]
 [-34.4767 -16.0137  -7.7228  -6.9406]]
u:
[0 0 0 1 0 1 1 1]
u_hat:
[0 0 0 1 0 1 1 1]
PASS: True
  master U:2 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:40:25  peva 
❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 43677 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.3321 -1.2003 -2.0683  0.196  -0.1419  0.8774  1.0844 -1.7393], scale: 0.7079457843841379
sbit:
[ 5.3158 -4.7896 -8.2537  0.7823 -0.5662  3.5012  4.3273 -6.9406], norm: 0.5011872336272722
L:
[[ 0.      0.      0.      5.3158]
 [ 0.      0.      0.     -4.7896]
 [ 0.      0.      0.     -8.2537]
 [ 0.      0.      0.      0.7823]
 [ 0.      0.      0.     -0.5662]
 [ 0.      0.      0.      3.5012]
 [ 0.      0.      0.      4.3273]
 [ 0.      0.      0.     -6.9406]]
L:
[[  0.5662   0.5662  -0.5662   5.3158]
 [  1.3485   0.7823  -3.5012  -4.7896]
 [  4.2835  -4.8935  -4.3273  -8.2537]
 [ -9.177   -4.2835  -0.7823   0.7823]
 [  5.882   -5.882   -5.882   -0.5662]
 [-13.6049  -7.7228   8.2908   3.5012]
 [-16.0137  18.463   12.581    4.3273]
 [-34.4767 -16.0137  -7.7228  -6.9406]]
u:
[0 0 0 1 0 1 1 1]
u_hat:
[0 0 0 1 0 1 1 1]
PASS: True
  master U:2 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:41:33  peva 
❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 47257 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.3321 -1.2003 -2.0683  0.196  -0.1419  0.8774  1.0844 -1.7393], scale: 0.7079457843841379
sbit:
[ 5.3158 -4.7896 -8.2537  0.7823 -0.5662  3.5012  4.3273 -6.9406], norm: 0.5011872336272722
L:
[[ 0.      0.      0.      5.3158]
 [ 0.      0.      0.     -4.7896]
 [ 0.      0.      0.     -8.2537]
 [ 0.      0.      0.      0.7823]
 [ 0.      0.      0.     -0.5662]
 [ 0.      0.      0.      3.5012]
 [ 0.      0.      0.      4.3273]
 [ 0.      0.      0.     -6.9406]]
Traceback (most recent call last):
  File "/home/peva/work/repos/polar-codes/test_polar.py", line 193, in <module>
    main(args.length)
  File "/home/peva/work/repos/polar-codes/test_polar.py", line 179, in main
    L[i + i_b, l+1], L[i + i_b + s_block, l+1])
                     ~^^^^^^^^^^^^^^^^^^^^^^^^
IndexError: index 8 is out of bounds for axis 0 with size 8
  master U:2 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:41:44  peva 
 1 ❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 40993 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.3321 -1.2003 -2.0683  0.196  -0.1419  0.8774  1.0844 -1.7393], scale: 0.7079457843841379
sbit:
[ 5.3158 -4.7896 -8.2537  0.7823 -0.5662  3.5012  4.3273 -6.9406], norm: 0.5011872336272722
L:
[[ 0.      0.      0.      5.3158]
 [ 0.      0.      0.     -4.7896]
 [ 0.      0.      0.     -8.2537]
 [ 0.      0.      0.      0.7823]
 [ 0.      0.      0.     -0.5662]
 [ 0.      0.      0.      3.5012]
 [ 0.      0.      0.      4.3273]
 [ 0.      0.      0.     -6.9406]]
Traceback (most recent call last):
  File "/home/peva/work/repos/polar-codes/test_polar.py", line 193, in <module>
    main(args.length)
  File "/home/peva/work/repos/polar-codes/test_polar.py", line 179, in main
    L[i + i_b, l+1], L[i + i_b + s_block, l+1])
                     ~^^^^^^^^^^^^^^^^^^^^^^^^
IndexError: index 8 is out of bounds for axis 0 with size 8
  master U:2 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:42:18  peva 
 1 ❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 38651 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.3321 -1.2003 -2.0683  0.196  -0.1419  0.8774  1.0844 -1.7393], scale: 0.7079457843841379
sbit:
[ 5.3158 -4.7896 -8.2537  0.7823 -0.5662  3.5012  4.3273 -6.9406], norm: 0.5011872336272722
L:
[[ 0.      0.      0.      5.3158]
 [ 0.      0.      0.     -4.7896]
 [ 0.      0.      0.     -8.2537]
 [ 0.      0.      0.      0.7823]
 [ 0.      0.      0.     -0.5662]
 [ 0.      0.      0.      3.5012]
 [ 0.      0.      0.      4.3273]
 [ 0.      0.      0.     -6.9406]]
L:
[[  0.5662   0.5662  -0.5662   5.3158]
 [  1.3485   0.7823  -3.5012  -4.7896]
 [  4.2835  -4.8935  -4.3273  -8.2537]
 [ -9.177   -4.2835  -0.7823   0.7823]
 [  5.882   -5.882   -5.882   -0.5662]
 [-13.6049  -7.7228   8.2908   3.5012]
 [-16.0137  18.463   12.581    4.3273]
 [-34.4767 -16.0137  -7.7228  -6.9406]]
u:
[0 0 0 1 0 1 1 1]
u_hat:
[0 0 0 1 0 1 1 1]
PASS: True
  master U:2 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:42:24  peva 
❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 58745 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.3321 -1.2003 -2.0683  0.196  -0.1419  0.8774  1.0844 -1.7393], scale: 0.7079457843841379
sbit:
[ 5.3158 -4.7896 -8.2537  0.7823 -0.5662  3.5012  4.3273 -6.9406], norm: 0.5011872336272722
L:
[[ 0.      0.      0.      5.3158]
 [ 0.      0.      0.     -4.7896]
 [ 0.      0.      0.     -8.2537]
 [ 0.      0.      0.      0.7823]
 [ 0.      0.      0.     -0.5662]
 [ 0.      0.      0.      3.5012]
 [ 0.      0.      0.      4.3273]
 [ 0.      0.      0.     -6.9406]]
  i: 0, a_llr: 2, s_block: 4, B: 0
  i: 0, a_llr: 2, s_block: 4, B: 0
  i: 0, a_llr: 2, s_block: 4, B: 0
  i: 0, a_llr: 2, s_block: 4, B: 0
  i: 0, a_llr: 2, s_block: 2, B: 0
  i: 0, a_llr: 2, s_block: 2, B: 0
  i: 0, a_llr: 2, s_block: 1, B: 0
  i: 1, a_llr: 0, s_block: 1, B: 1
  i: 2, a_llr: 1, s_block: 2, B: 1
  i: 2, a_llr: 1, s_block: 2, B: 1
  i: 2, a_llr: 1, s_block: 1, B: 0
  i: 3, a_llr: 0, s_block: 1, B: 1
  i: 4, a_llr: 2, s_block: 4, B: 1
  i: 4, a_llr: 2, s_block: 4, B: 1
  i: 4, a_llr: 2, s_block: 4, B: 1
  i: 4, a_llr: 2, s_block: 4, B: 1
  i: 4, a_llr: 2, s_block: 2, B: 0
  i: 4, a_llr: 2, s_block: 2, B: 0
  i: 4, a_llr: 2, s_block: 1, B: 0
  i: 5, a_llr: 0, s_block: 1, B: 1
  i: 6, a_llr: 1, s_block: 2, B: 1
  i: 6, a_llr: 1, s_block: 2, B: 1
  i: 6, a_llr: 1, s_block: 1, B: 0
  i: 7, a_llr: 0, s_block: 1, B: 1
L:
[[  0.5662   0.5662  -0.5662   5.3158]
 [  1.3485   0.7823  -3.5012  -4.7896]
 [  4.2835  -4.8935  -4.3273  -8.2537]
 [ -9.177   -4.2835  -0.7823   0.7823]
 [  5.882   -5.882   -5.882   -0.5662]
 [-13.6049  -7.7228   8.2908   3.5012]
 [-16.0137  18.463   12.581    4.3273]
 [-34.4767 -16.0137  -7.7228  -6.9406]]
u:
[0 0 0 1 0 1 1 1]
u_hat:
[0 0 0 1 0 1 1 1]
PASS: True
  master U:2 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:43:47  peva 
❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 43959 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.3321 -1.2003 -2.0683  0.196  -0.1419  0.8774  1.0844 -1.7393], scale: 0.7079457843841379
sbit:
[ 5.3158 -4.7896 -8.2537  0.7823 -0.5662  3.5012  4.3273 -6.9406], norm: 0.5011872336272722
L:
[[ 0.      0.      0.      5.3158]
 [ 0.      0.      0.     -4.7896]
 [ 0.      0.      0.     -8.2537]
 [ 0.      0.      0.      0.7823]
 [ 0.      0.      0.     -0.5662]
 [ 0.      0.      0.      3.5012]
 [ 0.      0.      0.      4.3273]
 [ 0.      0.      0.     -6.9406]]
  i: 0, a_llr: 2, s_block: 4, B: 0
  i: 0, a_llr: 2, s_block: 4, B: 0
  i: 0, a_llr: 2, s_block: 4, B: 0
  i: 0, a_llr: 2, s_block: 4, B: 0
  i: 0, a_llr: 2, s_block: 2, B: 0
  i: 0, a_llr: 2, s_block: 2, B: 0
  i: 0, a_llr: 2, s_block: 1, B: 0
  i: 1, a_llr: 0, s_block: 1, B: 1
  i: 2, a_llr: 1, s_block: 2, B: 1
  i: 2, a_llr: 1, s_block: 2, B: 1
  i: 2, a_llr: 1, s_block: 1, B: 0
  i: 3, a_llr: 0, s_block: 1, B: 1
  i: 4, a_llr: 2, s_block: 4, B: 0
Traceback (most recent call last):
  File "/home/peva/work/repos/polar-codes/test_polar.py", line 195, in <module>
    main(args.length)
  File "/home/peva/work/repos/polar-codes/test_polar.py", line 181, in main
    L[i + i_b, l+1], L[i + i_b + s_block, l+1])
                     ~^^^^^^^^^^^^^^^^^^^^^^^^
IndexError: index 8 is out of bounds for axis 0 with size 8
  master U:3 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:45:46  peva 
 1 ❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 52815 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.3321 -1.2003 -2.0683  0.196  -0.1419  0.8774  1.0844 -1.7393], scale: 0.7079457843841379
sbit:
[ 5.3158 -4.7896 -8.2537  0.7823 -0.5662  3.5012  4.3273 -6.9406], norm: 0.5011872336272722
L:
[[ 0.      0.      0.      5.3158]
 [ 0.      0.      0.     -4.7896]
 [ 0.      0.      0.     -8.2537]
 [ 0.      0.      0.      0.7823]
 [ 0.      0.      0.     -0.5662]
 [ 0.      0.      0.      3.5012]
 [ 0.      0.      0.      4.3273]
 [ 0.      0.      0.     -6.9406]]
  i: 0, a_llr: 2, s_block: 4, B: 0
  i: 0, a_llr: 2, s_block: 4, B: 0
  i: 0, a_llr: 2, s_block: 4, B: 0
  i: 0, a_llr: 2, s_block: 4, B: 0
  i: 0, a_llr: 2, s_block: 2, B: 0
  i: 0, a_llr: 2, s_block: 2, B: 0
  i: 0, a_llr: 2, s_block: 1, B: 0
  i: 1, a_llr: 0, s_block: 1, B: 1
  i: 2, a_llr: 1, s_block: 2, B: 1
  i: 2, a_llr: 1, s_block: 2, B: 1
  i: 2, a_llr: 1, s_block: 1, B: 0
  i: 3, a_llr: 0, s_block: 1, B: 1
  i: 4, a_llr: 2, s_block: 4, B: 1
  i: 4, a_llr: 2, s_block: 4, B: 1
  i: 4, a_llr: 2, s_block: 4, B: 1
  i: 4, a_llr: 2, s_block: 4, B: 1
  i: 4, a_llr: 2, s_block: 2, B: 0
  i: 4, a_llr: 2, s_block: 2, B: 0
  i: 4, a_llr: 2, s_block: 1, B: 0
  i: 5, a_llr: 0, s_block: 1, B: 1
  i: 6, a_llr: 1, s_block: 2, B: 1
  i: 6, a_llr: 1, s_block: 2, B: 1
  i: 6, a_llr: 1, s_block: 1, B: 0
  i: 7, a_llr: 0, s_block: 1, B: 1
L:
[[  0.5662   0.5662  -0.5662   5.3158]
 [  1.3485   0.7823  -3.5012  -4.7896]
 [  4.2835  -4.8935  -4.3273  -8.2537]
 [ -9.177   -4.2835  -0.7823   0.7823]
 [  5.882   -5.882   -5.882   -0.5662]
 [-13.6049  -7.7228   8.2908   3.5012]
 [-16.0137  18.463   12.581    4.3273]
 [-34.4767 -16.0137  -7.7228  -6.9406]]
u:
[0 0 0 1 0 1 1 1]
u_hat:
[0 0 0 1 0 1 1 1]
PASS: True
  master U:3 ?:1  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      15:46:59  peva 
❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 43587 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.3321 -1.2003 -2.0683  0.196  -0.1419  0.8774  1.0844 -1.7393], scale: 0.7079457843841379
sbit:
[ 5.3158 -4.7896 -8.2537  0.7823 -0.5662  3.5012  4.3273 -6.9406], norm: 0.5011872336272722
L:
[[ 0.      0.      0.      5.3158]
 [ 0.      0.      0.     -4.7896]
 [ 0.      0.      0.     -8.2537]
 [ 0.      0.      0.      0.7823]
 [ 0.      0.      0.     -0.5662]
 [ 0.      0.      0.      3.5012]
 [ 0.      0.      0.      4.3273]
 [ 0.      0.      0.     -6.9406]]
  i: 0, l: 2, s_block: 4, B: 0
  i: 0, l: 2, s_block: 4, B: 0
  i: 0, l: 2, s_block: 4, B: 0
  i: 0, l: 2, s_block: 4, B: 0
  i: 0, l: 1, s_block: 2, B: 0
  i: 0, l: 1, s_block: 2, B: 0
  i: 0, l: 0, s_block: 1, B: 0
  i: 1, l: 0, s_block: 1, B: 1
  i: 2, l: 1, s_block: 2, B: 1
  i: 2, l: 1, s_block: 2, B: 1
  i: 2, l: 0, s_block: 1, B: 0
  i: 3, l: 0, s_block: 1, B: 1
  i: 4, l: 2, s_block: 4, B: 1
  i: 4, l: 2, s_block: 4, B: 1
  i: 4, l: 2, s_block: 4, B: 1
  i: 4, l: 2, s_block: 4, B: 1
  i: 4, l: 1, s_block: 2, B: 0
  i: 4, l: 1, s_block: 2, B: 0
  i: 4, l: 0, s_block: 1, B: 0
  i: 5, l: 0, s_block: 1, B: 1
  i: 6, l: 1, s_block: 2, B: 1
  i: 6, l: 1, s_block: 2, B: 1
  i: 6, l: 0, s_block: 1, B: 0
  i: 7, l: 0, s_block: 1, B: 1
L:
[[  0.5662   0.5662  -0.5662   5.3158]
 [  1.3485   0.7823  -3.5012  -4.7896]
 [  4.2835  -4.8935  -4.3273  -8.2537]
 [ -9.177   -4.2835  -0.7823   0.7823]
 [  5.882   -5.882   -5.882   -0.5662]
 [-13.6049  -7.7228   8.2908   3.5012]
 [-16.0137  18.463   12.581    4.3273]
 [-34.4767 -16.0137  -7.7228  -6.9406]]
u:
[0 0 0 1 0 1 1 1]
u_hat:
[0 0 0 1 0 1 1 1]
PASS: True


Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.5434 -1.6263 -0.8925  1.1141 -1.3152  1.1351  0.6307 -1.6133], scale: 0.71
sbit:
[ 6.1591 -6.49   -3.5616  4.4458 -5.2482  4.5295  2.5168 -6.4381], norm: 0.50
L:
[[ 0.      0.      0.      6.1591]
 [ 0.      0.      0.     -6.49  ]
 [ 0.      0.      0.     -3.5616]
 [ 0.      0.      0.      4.4458]
 [ 0.      0.      0.     -5.2482]
 [ 0.      0.      0.      4.5295]
 [ 0.      0.      0.      2.5168]
 [ 0.      0.      0.     -6.4381]]
s_hat:
[[-1 -1 -1 -1]
 [-1 -1 -1 -1]
 [-1 -1 -1 -1]
 [-1 -1 -1 -1]
 [-1 -1 -1 -1]
 [-1 -1 -1 -1]
 [-1 -1 -1 -1]
 [-1 -1 -1 -1]]
a_llr: 2, a_bit: 0, B: 0
a_llr: 0, a_bit: 1, B: 1
  i: 1, l: 0, s_block: 1
a_llr: 1, a_bit: 0, B: 0
a_llr: 0, a_bit: 2, B: 1
  i: 3, l: 0, s_block: 1
  i: 3, l: 1, s_block: 2
a_llr: 2, a_bit: 0, B: 0
a_llr: 0, a_bit: 1, B: 1
  i: 5, l: 0, s_block: 1
a_llr: 1, a_bit: 0, B: 0
a_llr: 0, a_bit: 2, B: 1
  i: 7, l: 0, s_block: 1
  i: 7, l: 1, s_block: 2
L:
[[  2.5168   2.5168  -5.2482   6.1591]
 [  6.9626   4.4458  -4.5295  -6.49  ]
 [  7.7651  -7.7651  -2.5168  -3.5616]
 [-16.7404  -8.9753  -4.4458   4.4458]
 [  6.0784  -6.0784 -11.4073  -5.2482]
 [-16.9623 -10.8839  11.0195   4.5295]
 [-17.4858  17.4858   6.0784   2.5168]
 [-39.3891 -21.9033 -10.8839  -6.4381]]
s_hat:
[[ 0 -1 -1 -1]
 [ 0 -1 -1 -1]
 [ 0 -1 -1 -1]
 [ 1 -1 -1 -1]
 [ 0 -1 -1 -1]
 [ 1 -1 -1 -1]
 [ 1 -1 -1 -1]
 [ 1 -1 -1 -1]]
u:
[0 0 0 1 0 1 1 1]
u_hat:
[0 0 0 1 0 1 1 1]
PASS: True
SYMS: True
  master U:2  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      14:49:12  peva 
❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode-server/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 54557 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.5434 -1.6263 -0.8925  1.1141 -1.3152  1.1351  0.6307 -1.6133], scale: 0.71
sbit:
[ 6.1591 -6.49   -3.5616  4.4458 -5.2482  4.5295  2.5168 -6.4381], norm: 0.50
L:
[[ 0.      0.      0.      6.1591]
 [ 0.      0.      0.     -6.49  ]
 [ 0.      0.      0.     -3.5616]
 [ 0.      0.      0.      4.4458]
 [ 0.      0.      0.     -5.2482]
 [ 0.      0.      0.      4.5295]
 [ 0.      0.      0.      2.5168]
 [ 0.      0.      0.     -6.4381]]
s_hat:
[[-1 -1 -1 -1]
 [-1 -1 -1 -1]
 [-1 -1 -1 -1]
 [-1 -1 -1 -1]
 [-1 -1 -1 -1]
 [-1 -1 -1 -1]
 [-1 -1 -1 -1]
 [-1 -1 -1 -1]]
a_llr: 2, a_bit: 0, B: 0
a_llr: 0, a_bit: 1, B: 1
  i: 1, l: 0, s_block: 1
a_llr: 1, a_bit: 0, B: 0
a_llr: 0, a_bit: 2, B: 1
  i: 3, l: 0, s_block: 1
  i: 3, l: 1, s_block: 2
a_llr: 2, a_bit: 0, B: 0
a_llr: 0, a_bit: 1, B: 1
  i: 5, l: 0, s_block: 1
a_llr: 1, a_bit: 0, B: 0
a_llr: 0, a_bit: 2, B: 1
  i: 7, l: 0, s_block: 1
  i: 7, l: 1, s_block: 2
L:
[[  2.5168   2.5168  -5.2482   6.1591]
 [  6.9626   4.4458  -4.5295  -6.49  ]
 [  7.7651  -7.7651  -2.5168  -3.5616]
 [-16.7404  -8.9753  -4.4458   4.4458]
 [  6.0784  -6.0784 -11.4073  -5.2482]
 [-16.9623 -10.8839  11.0195   4.5295]
 [-17.4858  17.4858   6.0784   2.5168]
 [-39.3891 -21.9033 -10.8839  -6.4381]]
s_hat:
[[ 0 -1 -1 -1]
 [ 0 -1 -1 -1]
 [ 0 -1 -1 -1]
 [ 1 -1 -1 -1]
 [ 0 -1 -1 -1]
 [ 1 -1 -1 -1]
 [ 1 -1 -1 -1]
 [ 1 -1 -1 -1]]
u:
[0 0 0 1 0 1 1 1]
u_hat:
[0 0 0 1 0 1 1 1]
PASS: True
SYMS: True
  master U:2  ❲c❳ pynr-env  ~/work/repos/polar-codes                                                                                                      14:50:47  peva 
❯  cd /home/peva/work/repos/polar-codes ; /usr/bin/env /home/peva/miniforge3/envs/pynr-env/bin/python /home/peva/.vscode-server/extensions/ms-python.python-2023.20.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 38579 -- /home/peva/work/repos/polar-codes/test_polar.py -N 8 
Polar: N:8, n:3
a:
[1 1 1 1]
u:
[0 0 0 1 0 1 1 1]
s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]
x:
[0 1 1 0 1 0 0 1]
y:
[ 1.5434 -1.6263 -0.8925  1.1141 -1.3152  1.1351  0.6307 -1.6133], scale: 0.71
sbit:
[ 6.1591 -6.49   -3.5616  4.4458 -5.2482  4.5295  2.5168 -6.4381], norm: 0.50
L:
[[ 0.      0.      0.      6.1591]
 [ 0.      0.      0.     -6.49  ]
 [ 0.      0.      0.     -3.5616]
 [ 0.      0.      0.      4.4458]
 [ 0.      0.      0.     -5.2482]
 [ 0.      0.      0.      4.5295]
 [ 0.      0.      0.      2.5168]
 [ 0.      0.      0.     -6.4381]]
s_hat:
[[-1 -1 -1 -1]
 [-1 -1 -1 -1]
 [-1 -1 -1 -1]
 [-1 -1 -1 -1]
 [-1 -1 -1 -1]
 [-1 -1 -1 -1]
 [-1 -1 -1 -1]
 [-1 -1 -1 -1]]
a_llr: 2, a_bit: 0, B: 0
a_llr: 0, a_bit: 1, B: 1
  i: 1, l: 0, s_block: 1
a_llr: 1, a_bit: 0, B: 0
a_llr: 0, a_bit: 2, B: 1
  i: 3, l: 0, s_block: 1
  i: 3, l: 1, s_block: 2
a_llr: 2, a_bit: 0, B: 0
a_llr: 0, a_bit: 1, B: 1
  i: 5, l: 0, s_block: 1
a_llr: 1, a_bit: 0, B: 0
a_llr: 0, a_bit: 2, B: 1
  i: 7, l: 0, s_block: 1
  i: 7, l: 1, s_block: 2
L:
[[  2.5168   2.5168  -5.2482   6.1591]
 [  6.9626   4.4458  -4.5295  -6.49  ]
 [  7.7651  -7.7651  -2.5168  -3.5616]
 [-16.7404  -8.9753  -4.4458   4.4458]
 [  6.0784  -6.0784 -11.4073  -5.2482]
 [-16.9623 -10.8839  11.0195   4.5295]
 [-17.4858  17.4858   6.0784   2.5168]
 [-39.3891 -21.9033 -10.8839  -6.4381]]

s:
[[0 0 1 0]
 [0 0 1 1]
 [0 1 1 1]
 [1 1 1 0]
 [0 1 1 1]
 [1 1 0 0]
 [1 0 0 0]
 [1 1 1 1]]

s_hat:
[[ 0  0  1 -1]
 [ 0  0  1 -1]
 [ 0  1  1 -1]
 [ 1  1  1 -1]
 [ 0  1  1 -1]
 [ 1  1  0 -1]
 [ 1  0  0 -1]
 [ 1  1  1 -1]]

 s_hat:
[[ 0  0 -1 -1]
 [ 0  0  1 -1]
 [ 0  1 -1 -1]
 [ 1  1  1 -1]
 [ 0  1 -1 -1]
 [ 1  1  0 -1]
 [ 1  0 -1 -1]
 [ 1  1  1 -1]]
u:
[0 0 0 1 0 1 1 1]
u_hat:
[0 0 0 1 0 1 1 1]
PASS: True
SYMS: True

"""
...
